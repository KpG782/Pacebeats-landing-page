---
import UsersClient from './client/UsersClient';
---

<section 
    class="bg-black text-white py-20 px-6 overflow-hidden relative"
    id="users"
    aria-labelledby="users-heading"
    itemscope 
    itemtype="https://schema.org/SoftwareApplication"
>
    <!-- Geometric background pattern -->
    <div class="absolute inset-0 opacity-10" aria-hidden="true">
        <div class="absolute inset-0" style="background-image: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 11px), repeating-linear-gradient(-45deg, transparent, transparent 10px, rgba(255,255,255,0.03) 10px, rgba(255,255,255,0.03) 11px);"></div>
    </div>
    
    <div class="max-w-7xl mx-auto text-center relative z-10">
        <!-- Main heading with enhanced SEO structure -->
        <header class="mb-20 md:mb-24">
            <h2 
                id="users-heading" 
                class="text-4xl md:text-5xl lg:text-6xl font-black text-white font-inter leading-tight"
                itemprop="name"
            >
                <span class="block">Run Smarter. Track Progress.</span>
                <span class="block">Grow Together.</span>
            </h2>
            <p class="sr-only">
                Discover how Pacebeats helps runners track progress, set goals, and connect with a community of like-minded athletes through innovative features and social challenges.
            </p>
        </header>
        
        <!-- Phone mockups arrangement with enhanced accessibility -->
        <UsersClient client:load />
        
        <!-- Descriptive content with semantic markup -->
        <div class="max-w-4xl mx-auto mt-12 md:mt-16" role="region" aria-label="Application benefits">
            <p 
                class="text-gray-300 text-lg md:text-xl leading-relaxed font-inter"
                itemprop="description"
            >
                Pacebeats isn't just about running, it's about evolving.
                Track your real-time stats, set personal milestones, and unlock achievements as you go.
                Join challenges, climb leaderboards, and connect with a crew that pushes you further.
                Every step, every beat, every victoryâ€”shared and celebrated.
            </p>
            
            <!-- Hidden content for SEO -->
            <div class="sr-only">
                <h3>Key User Benefits</h3>
                <ul itemprop="featureList">
                    <li>Real-time running statistics and performance tracking</li>
                    <li>Social community features and runner profiles</li>
                    <li>Competitive challenges and leaderboards</li>
                    <li>Personalized training goals and progress monitoring</li>
                    <li>Achievement system and milestone celebrations</li>
                    <li>Group runs and team-based competitions</li>
                </ul>
                
                <div itemprop="applicationSubCategory">Community Running App</div>
                <div itemprop="interactionType">Social Fitness Tracking</div>
            </div>
        </div>
    </div>
</section>

<!-- JSON-LD Structured Data for User Features -->
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "SoftwareApplication",
    "name": "Pacebeats Community Features",
    "description": "Social running app featuring community challenges, progress tracking, and user profiles for runners",
    "applicationSubCategory": "Community Running App",
    "featureList": [
        "Real-time running statistics and performance tracking",
        "Social community features and runner profiles", 
        "Competitive challenges and leaderboards",
        "Personalized training goals and progress monitoring",
        "Achievement system and milestone celebrations",
        "Group runs and team-based competitions"
    ],
    "screenshot": [
        {
            "@type": "ImageObject",
            "url": "https://www.pacebeats.top/users-1.png",
            "description": "Main community dashboard featuring active runners and challenges"
        },
        {
            "@type": "ImageObject", 
            "url": "https://www.pacebeats.top/users-2.png",
            "description": "Community runner profile with statistics and achievements"
        },
        {
            "@type": "ImageObject",
            "url": "https://www.pacebeats.top/users-3.png", 
            "description": "Community challenges and competitive leaderboard"
        },
        {
            "@type": "ImageObject",
            "url": "https://www.pacebeats.top/users-4.png",
            "description": "Training progress and personalized goals interface"
        },
        {
            "@type": "ImageObject",
            "url": "https://www.pacebeats.top/users-5.png",
            "description": "Detailed running analytics and performance metrics"
        }
    ],
    "audience": {
        "@type": "Audience",
        "audienceType": "Running enthusiasts and fitness community members"
    }
}
</script>

<style>
    /* Inter font family for consistency */
    .font-inter {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
        letter-spacing: -0.025em;
    }
    
    /* Enhanced heading styling */
    h2.font-inter {
        text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.7);
        font-weight: 900;
    }
    
    /* Phone hover effects */
    .relative img,
    .absolute img {
        transition: all 0.3s ease;
        border-radius: 24px;
    }
    
    .relative img:hover,
    .absolute img:hover {
        transform: scale(1.05) rotate(0deg) !important;
        opacity: 1 !important;
        z-index: 30;
    }
    
    /* Responsive adjustments */
    @media (max-width: 1024px) {
        .absolute.left-0,
        .absolute.right-0 {
            display: none;
        }
    }
    
    @media (max-width: 768px) {
        .absolute.left-1\/4,
        .absolute.right-1\/4 {
            display: none;
        }
        
        .relative.z-20 img {
            width: 20rem;
        }
    }
    
    @media (max-width: 640px) {
        .relative.z-20 img {
            width: 18rem;
        }
        
        h2.font-inter {
            font-size: 2.5rem;
            line-height: 1.1;
        }
    }
    
    /* Floating dots animation */
    .animate-pulse {
        animation-duration: 2s;
    }
    
    /* Background pattern enhancement */
    .absolute.inset-0.opacity-10::before {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at 20% 80%, rgba(59, 130, 246, 0.05) 0%, transparent 50%),
                    radial-gradient(circle at 80% 20%, rgba(239, 68, 68, 0.05) 0%, transparent 50%);
    }
    
    /* Accessibility improvements */
    @media (prefers-reduced-motion: reduce) {
        .relative img,
        .absolute img {
            transition: none;
        }
        
        .animate-pulse {
            animation: none;
        }
        
        .relative img:hover,
        .absolute img:hover {
            transform: none !important;
        }
    }
    
    /* Focus styles for keyboard navigation */
    img:focus {
        outline: 3px solid rgba(59, 130, 246, 0.5);
        outline-offset: 4px;
    }
    
    /* Enhanced staggered animation for phone mockups */
    .phone-mockup {
        opacity: 0;
        transform: translateY(30px) scale(0.9);
        transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
        will-change: transform, opacity;
    }

    .phone-mockup.animate-in {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    /* Progressive delays for staggered effect */
    .phone-mockup[data-delay="0"] {
        transition-delay: 0ms;
    }

    .phone-mockup[data-delay="200"] {
        transition-delay: 200ms;
    }

    .phone-mockup[data-delay="400"] {
        transition-delay: 400ms;
    }

    .phone-mockup[data-delay="600"] {
        transition-delay: 600ms;
    }

    .phone-mockup[data-delay="800"] {
        transition-delay: 800ms;
    }

    /* Enhanced accessibility styles */
    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    /* Enhanced focus styles for keyboard navigation */
    img:focus {
        outline: 3px solid rgba(59, 130, 246, 0.8);
        outline-offset: 4px;
        transform: scale(1.05) !important;
        z-index: 40;
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
        h2.font-inter {
            text-shadow: 3px 3px 0px #000000;
            color: #ffffff;
        }
        
        .text-gray-300 {
            color: #ffffff;
        }
        
        img:focus {
            outline: 3px solid #ffffff;
            outline-offset: 4px;
        }
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
        .phone-mockup {
            transition: none;
            opacity: 1;
            transform: none;
        }
        
        .relative img,
        .absolute img {
            transition: none;
        }
        
        .animate-pulse {
            animation: none;
        }
        
        .relative img:hover,
        .absolute img:hover {
            transform: none !important;
        }
    }
</style>

<script>
    // Enhanced intersection observer for staggered phone animations
    if ('IntersectionObserver' in window) {
        const usersObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    const delay = parseInt(entry.target.getAttribute('data-delay') || '0');
                    
                    setTimeout(() => {
                        entry.target.classList.add('animate-in');
                        
                        // Announce to screen readers for the main phone
                        if (delay === 400) {
                            const announcement = document.createElement('div');
                            announcement.setAttribute('aria-live', 'polite');
                            announcement.className = 'sr-only';
                            announcement.textContent = 'Pacebeats community features section has loaded';
                            document.body.appendChild(announcement);
                            
                            setTimeout(() => {
                                if (document.body.contains(announcement)) {
                                    document.body.removeChild(announcement);
                                }
                            }, 2000);
                        }
                    }, delay);
                }
            });
        }, {
            threshold: 0.2,
            rootMargin: '50px'
        });
        
        // Observe all phone mockups
        document.querySelectorAll('.phone-mockup').forEach(phone => {
            usersObserver.observe(phone);
        });
    }
    
    // Enhanced keyboard navigation for phone images
    document.querySelectorAll('img[tabindex="0"]').forEach(img => {
        const handleKeydown = (e: KeyboardEvent) => {
            if (e.key === 'Enter' || e.key === ' ') {
                e.preventDefault();
                
                // Announce image details to screen readers
                const altText = (img as HTMLImageElement).getAttribute('alt');
                const announcement = document.createElement('div');
                announcement.setAttribute('aria-live', 'assertive');
                announcement.className = 'sr-only';
                announcement.textContent = `Viewing: ${altText}`;
                document.body.appendChild(announcement);
                
                // Focus the image
                (img as HTMLElement).focus();
                
                setTimeout(() => {
                    if (document.body.contains(announcement)) {
                        document.body.removeChild(announcement);
                    }
                }, 2000);
            }
        };
        
        (img as HTMLElement).addEventListener('keydown', handleKeydown);
    });
    
    // Performance optimization: Preload images
    if ('requestIdleCallback' in window) {
        requestIdleCallback(() => {
            const imageUrls = ['/users-1.png', '/users-2.png', '/users-3.png', '/users-4.png', '/users-5.png'];
            imageUrls.forEach(url => {
                const img = new Image();
                img.src = url;
            });
        });
    }
    
    // Enhanced error handling for images
    document.querySelectorAll('img').forEach(img => {
        img.addEventListener('error', () => {
            console.warn('Image failed to load:', img.src);
            // Provide fallback or hide broken image
            img.style.display = 'none';
        });
    });
</script>